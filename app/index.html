<!DOCTYPE html>
<html lang="en">

<head>

    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
    <title>PikeDeck</title>

    <!-- CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta.2/css/bootstrap.min.css" integrity="sha384-PsH8R72JQ3SOdhVi3uxftmaW6Vc51MKb0q5P2rRUpPvrszuE4W1povHYgTpBfshb" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Ranchers">


    <link rel="stylesheet" href="assets/css/plugins.css?v=00.00.01" />


    <style>
        .select2-container--default .select2-selection--single {
            background-color: #fff;
            border: 1px solid rgba(0, 0, 0, 0.15);
            border-radius: .25rem;
            height: 38px;
        }

        .select2-container--default .select2-selection--single .select2-selection__rendered {
            background-clip: padding-box;
            background-image: none;
            border-radius: .25rem;
            color: #495057;
            display: block;
            font-size: 1rem;
            line-height: 1.25;
            padding: .5rem .75rem;
            transition: border-color ease-in-out .15s, box-shadow ease-in-out .15s;
        }

        .select2-container--default .select2-selection--single .select2-selection__arrow {
            height: 38px;
            position: absolute;
            right: 1px;
            top: 1px;
            width: 20px;
        }

        .select2-selection--multiple .select2-search--inline .select2-search__field {
            width: auto !important;
        }

        .lazyload,
        .lazyloading {
            opacity: 0;
        }

        .lazyload {
            background: url("/assets/img/pika-loader.gif");
        }

        .lazyloaded {
            opacity: 1;
            transition: opacity 300ms;
        }

        a:focus,
        .btn-primary.focus,
        .btn-primary:focus,
        .btn.focus,
        .btn:focus {
            box-shadow: none;
            outline: 0;
        }

        html,
        body {
            margin: 0;
            padding: 0;
        }

        html {
            height: 100%;
        }

        img {
            height: auto;
            max-width: 100%;
        }

        .btn--icon-tada:hover i {
            animation-duration: 1s;
            animation-fill-mode: both;
            animation-name: rubberBand;
        }

        .card--tile {
            animation-duration: .5s;
            border-radius: 10px;
            box-shadow: 0 2px 2px 0 rgba(255, 136, 136, 0.5);
            overflow: hidden;
            transform: translateY(0);
            transition: 0.35s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .card--tile:hover {
            box-shadow: 0 6px 12px 0 rgba(255, 136, 136, 0.5);
            transform: translateY(-5px);
        }

        .card--tile .card__btn-group {
            border-collapse: separate;
            display: table;
            table-layout: fixed;
            width: 100%;
        }

        .card--tile .card__btn-group-btn {
            background: #fff8d1;
            border-color: #fff8d1;
            color: #f0ad4e;
            display: table-cell;
            float: none;
            width: 33.3%;
        }

        .card--tile .card__btn-group-btn:first-child {
            width: 33.4%;
        }

        .card--tile .card__btn-group-btn:hover {
            background: #f0ad4e;
            border-color: #fff8d1;
            color: #fff8d1;
        }

        .gutter-16 {
            margin-left: -8px;
            margin-right: -8px;
        }

        .gutter-16>[class^="col"],
        .gutter-16>[class^=" col"] {
            padding-left: 8px;
            padding-right: 8px;
        }

        .super-z {
            z-index: 9999;
        }

        .icon-set {
            height: 25px;
            width: 25px;
        }

        .icon-energy {
            background-image: url("/assets/img/energy-types.png");
            background-position: -25px 0;
            display: inline-block;
            height: 25px;
            width: 25px;
        }

        .icon-colorless {
            background-position: -25px 0;
        }

        .icon-darkness {
            background-position: 0 -50px;
        }

        .icon-dragon {
            background-position: 0 -25px;
        }

        .icon-electric {
            background-position: -25px -25px;
        }

        .icon-fairy {
            background-position: -50px 0;
        }

        .icon-fighting {
            background-position: -50px -25px;
        }

        .icon-fire {
            background-position: 0 0;
        }

        .icon-grass {
            background-position: -25px -50px;
        }

        .icon-lightning {
            background-position: -50px -50px;
        }

        .icon-metal {
            background-position: -75px 0;
        }

        .icon-psychic {
            background-position: -75px -25px;
        }

        .icon-water {
            background-position: -75px -50px;
        }

        .logo {
            display: inline-block;
            text-align: center;
        }

        .logo__text {
            color: #fff;
            font-family: 'Ranchers', cursive;
            font-size: 4rem;
            font-weight: 400;
            position: relative;
            text-shadow: 1px 1px 8px #f88;
            z-index: 2;
        }

        .logo__bg {
            height: 124px;
            margin-bottom: -83px;
        }

        .logo__bg path {
            animation: .5s logo-filling linear forwards;
            animation-delay: .5s;
            fill-opacity: 0;
        }

        .logo:hover,
        .logo:active {
            text-decoration: none;
        }

        .logo:hover .logo__text,
        .logo:hover .logo__bg,
        .logo:active .logo__text,
        .logo:active .logo__bg {
            animation-duration: 1s;
            animation-fill-mode: both;
            animation-iteration-count: 2;
        }

        .logo:hover .logo__text,
        .logo:active .logo__text {
            animation-name: logo-tada;
        }

        .logo:hover .logo__bg,
        .logo:active .logo__bg {
            animation-name: bounce;
        }

        @keyframes logo-filling {
            0% {
                fill-opacity: 0;
            }
            100% {
                fill-opacity: 1;
            }
        }

        @keyframes logo-tada {
            from {
                transform: scale3d(1, 1, 1);
            }
            10%,
            20% {
                transform: scale3d(0.9, 0.9, 0.9) rotate3d(0, 0, 1, -2deg);
            }
            30%,
            50%,
            70%,
            90% {
                transform: scale3d(1.05, 1.05, 1.05) rotate3d(0, 0, 1, 2deg);
            }
            40%,
            60%,
            80% {
                transform: scale3d(1.05, 1.05, 1.05) rotate3d(0, 0, 1, -2deg);
            }
            to {
                transform: scale3d(1, 1, 1);
            }
        }

        .search-options {
            background: #efac57;
            border: #efac57;
            padding: 10px;
        }

        .search-options label {
            color: #fff;
            margin-bottom: 0;
        }

        .img-set span {
            display: inline-block;
            width: 16px;
        }

        .img-set img {
            max-height: 16px;
            max-width: 16px;
            vertical-align: baseline;
        }

        body,
        .wrapper {
            background-image: linear-gradient(135deg, #fdeb71 10%, #f8d800 100%);
            min-height: 100%;
        }

        .ul-csv {
            display: inline;
            list-style: none;
            padding: 0;
        }

        .ul-csv li {
            display: inline;
            list-style: none;
            padding: 0;
        }

        .ul-csv li:not(:last-of-type)::after {
            content: ',';
            padding-right: 5px;
        }

        /*# sourceMappingURL=style.css.map */
    </style>
    <!-- /CSS -->

</head>

<body>

    <div class="wrapper">
        <div class="container">

            <!-- Header -->
            <!-- Header -->
            <div class="row">
                <div class="col-8">

                    <a href="index.html" class="logo">
            <svg class="logo__bg" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 400 400">
                <g>
                    <path id="logo-bg-fill" class="fill" fill="#F0AD4E" d="M117,117c0,0,0.2-67.2,57.5-112c0,0,12.5,31.5-28.8,101.5c0,0,36.1-9,73.3,15.9c0,0,53.7-24.4,115.4-2.4
              		c0,0-15.2,17.6-96,25l1.8,14c0,0,58.9-24.4,116.2-33.3c0,0-2,61.3-6.5,84.1l-91.5,5.5L289,248l-29.5,30.3l18.6,15.9L251.4,327
              		l-4.1-18.8l9.2-10.2l-14.7-9.9l-2.4-14.9l13.5-18.1l-18.6-18.9c0,0,0.4,26.3,3.7,33c3.3,6.7,2.2,18.7,7.6,34s12.5,48-11.3,67.8
              		c0,0,14.9,7.3,14.6,6c-0.3-1.2,7.9,6.9,7.9,6.9v5.5c0,0-5.1,5.1-33,0s-24.5-11.1-24.5-11.1l3-4.4c0,0-20.2-6.2-53.1-3.6l3,4.8
              		c0,0-19.9,18.1-52.5,15.2l-3.3-0.2l-1-2.5l-2-1.1c0,0-0.3-4.8,23.2-17c0,0-31.6-10.3-8.6-47.2c0,0,9.3-15.6,8.6-30.9
              		c0,0-15.4-2.2-20.5-20c0,0-7.1-15.6,22.3-35.9c0,0-32.8-21.1-30.9-42c0,0,2-10,7.2-16.3c5.3-6.3,5.9-19.8,5.9-19.8
              		s-2.8-9.1,7.3-26.9L117,117z"/>
                </g>
            </svg>
            <h1 class="logo__text">PikaDeck</h1>
        </a>

                </div>
                <div class="col-4 text-right">

                    <span>
            <a href="#" class="text-secondary" data-toggle="modal" data-target=".modal--donate">
              <i class="fa fa-coffee" aria-hidden="true"></i> Donate
            </a>
          </span>

                    <span>
            <a href="#" class="text-secondary" data-toggle="modal" data-target=".modal--help">
              <i class="fa fa-question-circle" aria-hidden="true"></i> Help
            </a>
          </span>

                </div>
            </div>
            <!-- /Header -->
            <!-- /Header -->

            <div id="browse">

                <form id="pika_filters">

                    <div class="row gutter-16">
                        <div class="col">

                            <div class="input-group">
                                <input name="name" id="poke_search" type="text" class="form-control form-control-lg" placeholder="Search by Card Name">
                                <span class="input-group-btn">
                      <button id="pika_search" class="btn btn-primary btn-lg btn--icon-tada" type="button">
                        <i class="fa fa-search" aria-hidden="true"></i>
                      </button>
                    </span>
                            </div>

                        </div>
                        <div class="col-auto">

                            <button id="view_deck" class="btn btn-primary btn-lg btn--icon-tada" type="button">
                    <i class="fa fa-th" aria-hidden="true"></i> Deck
                    <span class="count"></span>
                </button>

                        </div>
                    </div>

                    <a class="" data-toggle="collapse" href="#search_options" aria-expanded="false" aria-controls="xxx">
            <small>Search Options <span id="search_options_count"></span></small>
        </a>

                    <div class="collapse multi-collapse" id="search_options">
                        <div class="search-options rounded">

                            <div class="form-group mb-2">
                                <label for="poke_set">Set</label>
                                <select name="setCode" id="poke_set" class="form-control" multiple="multiple" style="width: 100%">
                        <option>Loading...</option>
                    </select>
                            </div>

                            <div class="form-group mb-2">
                                <label for="poke_type">Type</label>
                                <select name="types" id="poke_type" class="form-control" multiple="multiple" style="width: 100%">
                        <option>Loading...</option>
                    </select>
                            </div>

                            <div class="form-group mb-2">
                                <label for="poke_supertype">Supertype</label>
                                <select name="supertype" id="poke_supertype" class="form-control" multiple="multiple" style="width: 100%">
                        <option>Loading...</option>
                    </select>
                            </div>

                            <div class="form-group mb-0">
                                <label for="poke_subtype">Subtype</label>
                                <select name="subtype" id="poke_subtype" class="form-control" multiple="multiple" style="width: 100%">
                        <option>Loading...</option>
                    </select>
                            </div>

                        </div>
                    </div>

                </form>

                <div id="poke_cards" class="row gutter-16 mt-3"></div>

            </div>

            <!-- Footer -->

            <!-- /Footer -->

        </div>
    </div>


    <!-- Handlebar Templates -->
    <!-- Handlebars: Info Modal Content -->
    <script id="hb_card_info" type="text/x-handlebars-template">
        <div class="modal-header">
            <h5 class="modal-title" id="exampleModalLabel">{{name}}</h5>
            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
        </button>
        </div>
        <div class="modal-body">

            <div class="card text-white bg-secondary mb-3">
                <div class="card-body">

                    <div class="row">
                        <div class="col-8">
                            {{#if supertype}}
                            <h4 class="card-title">
                                {{supertype}}{{#if subtype}}-{{subtype}}{{/if}}
                            </h4>
                            {{/if}}
                        </div>
                        <div class="col-4 text-right">
                            {{#if hp}}
                            <h4 class="card-title">
                                <small>HP</small>{{hp}} {{#if types}} {{#each types}}{{energyType this}}{{/each}} {{/if}}
                            </h4>
                            {{/if}}
                        </div>
                    </div>

                    {{#if evolvesFrom}}
                    <div class="card-text">Evolves From: {{evolvesFrom}}</div>
                    {{/if}}

                </div>
            </div>

            {{#if text}}
            <div class="mb-4">
                <small class="text-secondary">{{#each text}}{{this}} {{/each}}</small>
            </div>
            {{/if}} {{#if ability}}
            <div class="mb-4">
                <strong class="text-success">{{ability.type}}</strong>
                <h4>{{ability.name}}</h4>
                {{ability.text}}
            </div>
            {{/if}} {{#if attacks}} {{#each attacks}}
            <div class="mb-4">
                <div class="row">
                    <h4 class="col-8">
                        {{#if cost}}{{#each cost}}{{energyType this}}{{/each}}{{/if}} {{name}}
                    </h4>
                    {{#if damage}}
                    <h4 class="col-4 text-right">{{damage}}</h4>
                    {{/if}}
                </div>
                {{text}}
            </div>
            {{/each}} {{/if}} {{#ifAny weaknesses resistances retreatCost}}
            <div class="card mb-3">
                <div class="card-body">
                    <div class="row">
                        <div class="col-4">
                            Weaknesses<br> {{#each weaknesses}}{{energyType type}} {{value}}{{/each}}
                        </div>
                        <div class="col-4">
                            Resistances<br> {{#each resistances}}{{energyType type}} {{value}}{{/each}}
                        </div>
                        <div class="col-4">
                            Retreat Cost<br> {{#each retreatCost}}{{energyType this}}{{/each}}
                        </div>
                    </div>
                </div>
            </div>
            {{/ifAny}}

            <div class="row">
                <div class="col-8">
                    <h5 class="mb-0">
                        <img class="icon-set" src="{{setSymbolUrl setCode}}"> {{set}}
                    </h5>
                </div>
                <div class="col-4 text-right">
                    <h5 class="mb-0">
                        {{number}}/{{setData setCode "totalCards"}}
                    </h5>
                </div>
            </div>

            <div>
                <small class="text-secondary">
                {{series}}
                | Set Code: {{setCode}}
                | PTCGO Code: {{setData setCode "ptcgoCode"}}
            </small>
            </div>

            <div>
                <small class="text-secondary">
                Released: {{setData setCode "releaseDate"}}
                | Tournament Type: {{tournamentType setCode}}
            </small>
            </div>

            <hr>

            <div class="row">
                <div class="col-6">
                    <small class="text-secondary">
                    Artist: {{artist}}
                </small>
                </div>
                {{#if nationalPokedexNumber}}
                <div class="col-6 text-right">
                    <small class="text-secondary">
                    National Pokedex: {{nationalPokedexNumber}}
                </small>
                </div>
                {{/if}}
            </div>

        </div>
    </script>

    <!-- Handlebars: Card Tile -->
    <script id="hb_card_tile" type="text/x-handlebars-template">
        {{#each .}}
        <div class="col-6 col-sm-4 col-md-3 col-lg-2 mb-3">
            <div class="card card--tile p-1">
                <a href="#" data-info="{{id}}" data-toggle="modal" data-target=".modal--info">
                <img class="lazyload card-img-top" data-src="{{imageUrl}}" src="https://images.pokemontcg.io/xy0/symbol.png">
            </a>
                <div class="card__btn-group btn-group mt-1" role="group" aria-label="...">

                    <button data-add="{{id}}" type="button" class="card__btn-group-btn btn btn--icon-tada" data-toggle="tooltip" title="Add to Deck">
                    <i class="fa fa-plus-circle" aria-hidden="true"></i>
                </button>

                    <button data-print="{{id}}" type="button" class="card__btn-group-btn btn btn--icon-tada" data-toggle="tooltip" title="Print Play Set">
                    <i class="fa fa-print" aria-hidden="true"></i>
                </button>

                    <button data-zoom="{{id}}" type="button" class="card__btn-group-btn btn btn--icon-tada" data-toggle="modal" data-target=".modal--zoomed" data-toggle="tooltip" title="Detialed View">
                    <i class="fa fa-search-plus" aria-hidden="true"></i>
                </button>

                </div>
            </div>
        </div>
        {{/each}}
    </script>

    <!-- Handlebars: Loading Cards -->
    <script id="hp_loading_cards" type="text/x-handlebars-template">
        <div class="col-12 text-center">
            <img class="rounded-circle" src="https://cdn-enterprise.discourse.org/gethopscotch1/uploads/default/original/2X/b/ba7205fa30058920f98195c0d79a98eeeb00029c.gif">
        </div>
    </script>

    <!-- Handlebars: No Matches -->
    <script id="hp_no_results" type="text/x-handlebars-template">
        <div class="col-12 text-center">
            <h1><small>Nothing Found</small></h1>
            <img class="rounded-circle bg-primary" src="https://1.bp.blogspot.com/-SC_s2eSLONM/WSYyeNTZoZI/AAAAAAAHrXo/R40duxNw4Ego7Gy6eC7WTWBj2T2ysNAhACLcB/s1600/AS002653_13.gif">
            <h2>Noooo!!!!</h2>
        </div>
    </script>

    <!-- /Handlebar Templates -->


    <!-- Bootstrap Modals -->
    <!-- Modal: Info -->
    <div class="modal fade modal--info" tabindex="-1" role="dialog" aria-labelledby="cardInfo" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-body">Loading...</div>
            </div>
        </div>
    </div>

    <!-- Modal: Card Zoom -->
    <div class="modal fade modal--zoomed" tabindex="-1" role="dialog" aria-labelledby="imageZoomed" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <img class="image-hi-res" data-zoomed>
            </div>
        </div>
    </div>

    <!-- Modal: Donate -->
    <div class="modal fade modal--donate" tabindex="-1" role="dialog" aria-labelledby="modalDonate" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Support a great cause, then support PikaProxy!</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
                </div>
                <div class="modal-body">
                    ...
                </div>
            </div>
        </div>
    </div>

    <!-- Modal: Help -->
    <div class="modal fade modal--help" tabindex="-1" role="dialog" aria-labelledby="modalHelp" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">How to use PikaProxy</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
                </div>
                <div class="modal-body">
                    ...
                </div>
            </div>
        </div>
    </div>

    <!-- /Bootstrap Modals -->


    <!-- JS -->
    <script src="https://code.jquery.com/jquery-3.2.1.min.js" integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.3/umd/popper.min.js" integrity="sha384-vFJXuSJphROIrBnz7yo7oB41mKfc8JzQZiCq4NCceLEaO4IHwicKwpJf9c9IpFgh" crossorigin="anonymous"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta.2/js/bootstrap.min.js" integrity="sha384-alpBpkh1PFOepccYVYDB4do5UnbKysX5WZXm3XxPqe5iKTfUKjNkCk9SaVuEZflJ" crossorigin="anonymous"></script>


    <script src="assets/js/plugins.js?v=00.00.01"></script>


    <script type="text/javascript">
        // TODO: Look into sorting cards by number.
        // TODO: Using local store across sessions is problematic.  Need to flush localstore on startup?

        var tcgPrinter = {
            apiPath: 'https://api.pokemontcg.io/v1/',
            lookup: {},
            init: function() {

                this.initToaster();
                this.initBootstrap();
                this.initHandlebarsHelpers();
                this.bindEvents();
                this.storeQuery();

                //var card ='https://images.pokemontcg.io/base1/31.png';
                //this.getImage(card);

            },

            pushQuery: function(params) {

                // TODO: Need to test back button behavior and see if I need to
                // do any history cleanup.

                queryString.removeAll();

                // TODO: What about a single query item? No & just =?
                params = params.split('&');

                for (var i = 0; i < params.length; i++) {

                    var item = params[i].split('=');

                    var name = item[0];

                    var value = decodeURIComponent(item[1]);

                    queryString.push(name, value);

                }

            },
            getQuery: function() {

                var query = window.location.search;

                if (query.indexOf('?') === 0) {
                    query = query.replace('?', '');
                }

                return query;

            },
            storeQuery: function() {

                var query = this.queryToObject(this.getQuery());

                this.lookup.query = query;

                $(document).trigger('store_query_done', [query]);

            },

            bindEvents: function() {

                var that = this;

                $(document).on('click', 'button#pika_search', function() {

                    $('#search_options').collapse('hide');

                    var params = that.getParams();

                    that.pushQuery(params);

                    that.storeQuery();

                    that.getCards(params);

                });

                $(document).on('click', 'button#view_deck', function() {

                    if (that.lookup && that.lookup.cart && that.lookup.cart.length > 0) {

                        var cart = that.lookup.cart.join('|');
                        queryString.removeAll();
                        queryString.push('deck', cart);

                        that.getDeck(that.lookup.cart);

                    } else {

                        toastr.warning('No cards have been added to your deck!');

                    }

                });

                $(document).on('store_query_done', function(e, query) {

                    $('#poke_search').val(that.lookup.query.name);

                    if (that.lookup.query.deck) {
                        that.lookup.cart = that.lookup.query.deck || [];
                        delete that.lookup.query.deck;
                        $('.count', '#view_deck').html('(' + that.lookup.cart.length + ')');
                    }

                    that.drawSearchOptionsCount(query);

                    that.getSimpleData('types');
                    that.getSimpleData('subtypes');
                    that.getSimpleData('supertypes');
                    that.getSets();

                });

                $(document).on('draw_sets_done', function() {

                    var params = that.getQuery();

                    if (params.indexOf('deck=') !== -1) {

                        that.getDeck(that.lookup.cart);

                    } else {

                        that.getCards(params);
                        $('#poke_set').val(that.lookup.query.setCode).trigger('change');

                    }

                });

                $(document).on('click', 'button[data-add]', function() {

                    that.lookup.cart = that.lookup.cart || [];

                    var id = $(this).data().add;

                    var data = that.lookup.cards[id];
                    var inCart = that.countInArray(that.lookup.cart, id);
                    var isBasicEnergy = (data.supertype === "Energy" && data.subtype === "Basic");

                    var isCartMaxReached = that.lookup.cart.length >= 60;
                    var isItemMaxReached = (!isBasicEnergy && inCart >= 4);

                    // if isCartMax
                    // Alert: You can only add 60 cards to a deck.

                    // if notBasicEngery && isItemMax
                    // Alert: Only 4 copies allowed

                    // Else add to deck and alert user.

                    if (isCartMaxReached) {
                        toastr.warning("You have 60 cards selected which is the max allowed within a deck.");
                        return;
                    }

                    if (isItemMaxReached) {
                        toastr.warning("When you are building a deck, you can have only 4 copies of a card with the same name in it, except for basic Energy cards.");
                        return;
                    }


                    // TODO: Look over animate.css docs. Look for reusable way of doing this...
                    $(this).closest('.card--tile').addClass('fadeOutDownBig animated super-z').one('webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend', function() {
                        $(this).removeClass('fadeOutDownBig animated super-z').addClass('rotateIn animated super-z').one('webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend', function() {
                            $(this).removeClass('rotateIn animated super-z');
                        });
                    });


                    that.lookup.cart.push(id);
                    inCart = inCart + 1;

                    $('.count', '#view_deck').html('(' + that.lookup.cart.length + ')');

                    var text = "Added " + data.name;
                    if (!isBasicEnergy) {
                        text = text + " (" + inCart + " of 4)";
                    } else {
                        text = text + " (" + inCart + " in deck)";
                    }

                    toastr.success(text);

                    $('img', '.proxy-cart__card').one('webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend', function() {
                        $(this).removeClass('bounceInUp animated');
                    });




                });

                $(document).on('click', 'button[data-print]', function() {
                    console.log($(this).data().print);
                });

                $(document).on('click', '[data-info]', function() {

                    // TODO: Move this into a draw statement...
                    var id = $(this).data().info;
                    var data = that.lookup.cards[id];

                    var template = Handlebars.compile($("#hb_card_info").html());
                    $('.modal-content', '.modal--info').html(template(data));

                });

                $(document).on('click', '[data-zoom]', function() {

                    var id = $(this).data().zoom;
                    var imageUrlHiRes = that.lookup.cards[id].imageUrlHiRes;
                    $('[data-zoomed]', '.modal--zoomed').attr('src', imageUrlHiRes);

                });

                $(document).on('shown.bs.collapse', function() {

                    //$('select', '#pika_search').trigger('change');

                    $('.proxy-cart__slider').slick('setPosition');
                });

                $(document).on('get_sets_done', function(e, data, lookup, tournamentSets) {
                    that.lookup.sets = lookup;
                    that.lookup.tournamentSets = tournamentSets;
                    that.drawSets(data);

                });

                $(document).on('get_types_done', function(e, data) {
                    var items = that.getTypeOptions(data);
                    if (items) {
                        that.drawTypes(items);
                    }
                });

                $(document).on('get_subtypes_done', function(e, data) {
                    var items = that.getTypeOptions(data);
                    if (items) {
                        that.drawSubtypes(items);
                    }
                });

                $(document).on('get_supertypes_done', function(e, data) {
                    var items = that.getTypeOptions(data);
                    if (items) {
                        that.drawSupertypes(items);
                    }
                });

                $(document).on('get_cards_done', function(e, data, lookup) {
                    that.lookup.cards = lookup;
                    that.drawCards(data);
                });



                $(document).on('draw_types_done', function() {
                    $('#poke_type').val(that.lookup.query.types).trigger('change');
                });

                $(document).on('draw_subtypes_done', function() {
                    $('#poke_subtype').val(that.lookup.query.subtype).trigger('change');
                });

                $(document).on('draw_supertypes_done', function() {
                    $('#poke_supertype').val(that.lookup.query.supertype).trigger('change');
                });

                $(document).on('getting_cards', function() {

                    var nodata = Handlebars.compile($("#hp_loading_cards").html());
                    $('#poke_cards').html(nodata());

                });

                // $(document).on('card_ready', function(e, data) {
                //   console.log(data);
                // });
                // $('#pika_filters').on('change', 'select', function() {
                //   $(document).trigger('form_upated');
                // });

            },

            getSets: function() {

                var that = this;

                // If exists in localstore...
                var data = store.get('sets') || [];
                if (data.sets && data.sets.length > 0) {

                    // Create lookup table...
                    var lookup = this.getLookupTable(data.sets, 'code');

                    // Get standard sets...
                    // TODO: Consider a combined loop with getLookupTable...
                    var tournamentSets = this.getTournamentSets(data.sets);

                    $(document).trigger('get_sets_done', [data.sets, lookup, tournamentSets]);
                    return;
                }

                // Else get new data...
                $.ajax({
                    dataType: "json",
                    url: this.apiPath + 'sets',
                    success: function(data) {

                        // Show latest set first...
                        if (data && data.sets && data.sets.length > 0) {
                            data.sets.reverse();
                        }

                        // Save response to localStore...
                        store.set('sets', data);

                        // Call getSets again, data should be in localStore now...
                        // TODO: This is a bit dangerous.  Need to consider better method.
                        that.getSets();

                    },
                    error: function(xhr, status, error) {
                        console.log([xhr, status, error]);
                    }
                });

            },
            getSimpleData: function(endpoint) {

                var that = this;

                // If exists in localstore...
                var data = store.get(endpoint) || [];
                if (data[endpoint] && data[endpoint].length > 0) {

                    $(document).trigger('get_' + endpoint + '_done', [data[endpoint]]);
                    return;

                }

                $.ajax({
                    dataType: "json",
                    url: this.apiPath + endpoint,
                    success: function(data) {

                        // Save response to localStore...
                        store.set(endpoint, data);

                        // Call getSets again, data should be in localStore now...
                        // TODO: This is a bit dangerous.  Need to consider better method.
                        that.getSimpleData(endpoint);

                    },
                    error: function(xhr, status, error) {
                        console.log([xhr, status, error]);
                    }
                });

            },
            getCards: function(params) {

                $(document).trigger('getting_cards');

                this.drawDeckButtonEnabled();

                params = (params) ? params : this.getDefaultParams(this.lookup.tournamentSets.standard);

                var that = this;


                // TODO: Pass params as data...
                var endpoint = this.apiPath + 'cards' + '?pageSize=60&' + params;


                // Else get new data...
                $.ajax({
                    dataType: "json",
                    url: endpoint,
                    success: function(data) {

                        // Create lookup table...
                        var lookup = that.getLookupTable(data.cards, 'id');

                        $(document).trigger('get_cards_done', [data.cards, lookup]);

                    },
                    error: function(xhr, status, error) {
                        console.log([xhr, status, error]);
                    }
                });

            },
            getDeck: function(deck) {

                // $(document).trigger('getting_cards');
                //
                // this.drawDeckButtonDisabled();
                //
                // // TODO: Look at stripping duplicate items from deck here.
                // var that = this;
                // var promises = [];
                // var cards = [];
                //
                // for (var i = 0; i < deck.length; i++){
                //
                //     var endpoint = this.apiPath + 'cards/' + deck[i];
                //
                //     var request = $.getJSON(endpoint, function (data) {
                //
                //         that.lookup.cards = that.lookup.cards || {};
                //
                //         that.lookup.cards[data.card.id] = data.card;
                //
                //         cards.push(data.card);
                //
                //         //$(document).trigger('get_cards_done', [data.cards, lookup]);
                //
                //     });
                //
                //     promises.push(request);
                // }
                //
                // $.when.apply(null, promises).done(function(){
                //
                //     that.drawCards(cards);
                //
                // });

            },


            getParams: function() {

                var data = $('#pika_filters').serializeArray();

                if (data && data.length > 0) {

                    var newData = {};

                    for (var i = 0; i < data.length; i++) {

                        if (newData[data[i].name]) {

                            newData[data[i].name] = newData[data[i].name] + '|' + data[i].value;

                        } else {

                            if (data[i].value) {

                                newData[data[i].name] = data[i].value;

                            }
                        }

                    }

                    newData = $.param(newData, true);

                    return newData;

                }

                return null;

            },

            drawSets: function(data) {

                var items = this.getSetOptions(data);

                $('#poke_set').html(items).select2({
                    placeholder: "Select a set",
                    allowClear: true,
                    templateResult: this.getSelect2SetOptions,
                    templateSelection: this.getSelect2SetOptions
                });

                $(document).trigger('draw_sets_done');

            },
            drawTypes: function(items) {

                $('#poke_type').html(items).select2({
                    placeholder: "Select a Type",
                    allowClear: true
                });

                $(document).trigger('draw_types_done');

            },
            drawSubtypes: function(items) {

                $('#poke_subtype').html(items).select2({
                    placeholder: "Select a Subtype",
                    allowClear: true
                });

                $(document).trigger('draw_subtypes_done');

            },
            drawSupertypes: function(items) {

                $('#poke_supertype').html(items).select2({
                    placeholder: "Select a Supertype",
                    allowClear: true
                });

                $(document).trigger('draw_supertypes_done');

            },
            drawCards: function(data) {

                if (data.length !== 0) {

                    var template = Handlebars.compile($("#hb_card_tile").html());
                    $('#poke_cards').html(template(data));

                } else {

                    var nodata = Handlebars.compile($("#hp_no_results").html());
                    $('#poke_cards').html(nodata());

                }

                $(document).trigger('draw_cards_done');

            },
            drawSearchOptionsCount: function(query) {

                var queryCount = Object.keys(query).length;

                if (queryCount === 1 && !query.name || queryCount >= 2) {

                    var count = (query.name) ? queryCount - 1 : queryCount;

                    $('#search_options_count').html(' (' + count + ')');

                } else {

                    $('#search_options_count').html('');

                }

            },
            drawDeckButtonDisabled: function() {

                $('button#view_deck')
                    .attr('disabled', 'disabled')
                    .removeClass('btn-primary btn--icon-tada')
                    .addClass('btn-secondary');

            },
            drawDeckButtonEnabled: function() {

                $('button#view_deck')
                    .removeAttr('disabled')
                    .removeClass('btn-secondary')
                    .addClass('btn-primary btn--icon-tada');

            },

            initHandlebarsHelpers: function() {

                var that = this;

                Handlebars.registerHelper('energyType', function(type) {

                    type = type.toLowerCase();

                    type = Handlebars.Utils.escapeExpression(type.toLowerCase());

                    var result = '<i class="icon-energy icon-' + type + '"></i>';

                    return new Handlebars.SafeString(result);

                });

                Handlebars.registerHelper('setData', function(setCode, key) {

                    setCode = Handlebars.Utils.escapeExpression(setCode);
                    key = Handlebars.Utils.escapeExpression(key);

                    // TODO: Should check for existence of nodes in object...
                    var value = that.lookup.sets[setCode][key];

                    return new Handlebars.SafeString(value);
                });

                Handlebars.registerHelper('tournamentType', function(setCode) {

                    setCode = Handlebars.Utils.escapeExpression(setCode);

                    // TODO: Should check for existence of nodes in object...
                    var standardLegal = that.lookup.sets[setCode].standardLegal;
                    var expandedLegal = that.lookup.sets[setCode].expandedLegal;

                    var value = (standardLegal) ? 'Standard' : (expandedLegal) ? 'Expanded' : 'Unlimited';

                    return new Handlebars.SafeString(value);
                });

                Handlebars.registerHelper('setSymbolUrl', function(setCode) {

                    setCode = Handlebars.Utils.escapeExpression(setCode);

                    // TODO: Should check for existence of nodes in object...
                    var symbolUrl = that.lookup.sets[setCode].symbolUrl;

                    return new Handlebars.SafeString(symbolUrl);
                });

                Handlebars.registerHelper('ifAny', function(v1, v2, v3, options) {
                    if (v1 || v2 || v3) {
                        return options.fn(this);
                    }
                    return options.inverse(this);
                });

            },
            initToaster: function() {

                toastr.options = {
                    "closeButton": false,
                    "debug": false,
                    "newestOnTop": false,
                    "progressBar": false,
                    "positionClass": "toast-bottom-right",
                    "preventDuplicates": false,
                    "onclick": null,
                    "showDuration": "300",
                    "hideDuration": "1000",
                    "timeOut": "5000",
                    "extendedTimeOut": "1000",
                    "showEasing": "swing",
                    "hideEasing": "linear",
                    "showMethod": "fadeIn",
                    "hideMethod": "fadeOut"
                };

            },
            initBootstrap: function() {

                $('[data-toggle="tooltip"]').tooltip();

            },

            getImage: function(card) {

                this.imgToBase64(card, function(dataUrl) {


                    //6.3 cm x 8.8 cm
                    //2.48031 in X 3.46457 in

                    // var doc = new jsPDF({
                    //   orientation: 'portrait',
                    //   unit: 'in',
                    //   format: [11, 8.5]
                    // });

                    //doc.text('Hello world!', 1, 1);
                    //doc.addImage(dataUrl, 'PNG', 1, 1, 2.48, 3.46)
                    //doc.save('poke-proxy.pdf');

                    //$(document).trigger('card_ready', [dataUrl]);

                });

            },
            imgToBase64: function(url, callback) {

                var proxy = 'https://galvanize-cors-proxy.herokuapp.com/';
                var xhr = new XMLHttpRequest();
                xhr.onload = function() {
                    var reader = new FileReader();
                    reader.onloadend = function() {
                        callback(reader.result);
                    };
                    reader.readAsDataURL(xhr.response);
                };
                xhr.open('GET', proxy + url);
                xhr.responseType = 'blob';
                xhr.send();

            },


            // TODO: Add Unit Tests
            // ------------------------------------------
            getLookupTable: function(data, lookupKey) {

                var lookup = {};

                for (var i = 0; i < data.length; i++) {
                    lookup[data[i][lookupKey]] = data[i];
                }

                return lookup;

            },
            getTournamentSets: function(data) {

                var standard = [];
                var expanded = [];

                for (var i = 0; i < data.length; i++) {

                    if (data[i].standardLegal) {
                        standard.push(data[i].code);
                    }

                    if (data[i].expandedLegal) {
                        expanded.push(data[i].code);
                    }

                }

                return {
                    standard: standard,
                    expanded: expanded
                };

            },
            getDefaultParams: function(standardSets) {

                // SHAME: This is not pretty.
                // TODO: Ugh. Some of the cards in the DB do not include a rarity. So either need to live with it, or
                // Pull back all raritys and then remove common and uncommon cards post get. :(
                // Removing Generations and Evolutions as artwork is ugly ;P
                standardSets = this.removeFromArray(standardSets, 'g1');
                standardSets = this.removeFromArray(standardSets, 'xy12');
                standardSets = standardSets.join('|');

                return 'supertype=Pokemon|Trainer' +
                    '&subtype=GX|EX|Mega|Supporter' +
                    '&rarity=Rare%20Ultra|Rare%20Holo%20gx|Rare%20Holo%20EX' +
                    '&setCode=' + standardSets;

            },
            getTypeOptions: function(data) {

                if (data && data.length > 0) {

                    var items = [];

                    for (var i = 0; i < data.length; i++) {
                        items.push('<option value="' + data[i] + '">' + data[i] + '</option>');
                    }

                    return items.join('');
                }

                return null;

            },
            getSetOptions: function(data) {

                var items = [];

                $.each(data, function(key, val) {
                    items.push('<option value="' + val.code + '">' + val.name + ' (' + val.ptcgoCode + ')</option>');
                });

                return items.join('');

            },
            getSelect2SetOptions: function(state) {

                if (!state.id) {
                    return state.text;
                }

                var baseUrl = 'https://images.pokemontcg.io';

                var html = $(
                    '<span class="img-set">' +
                    '<span><img src="' + baseUrl + '/' + state.element.value.toLowerCase() + '/symbol.png" /></span> ' +
                    state.text +
                    '</span>'
                );

                return html;
            },
            queryToObject: function(query) {

                var queryObj = {};

                if (query === "") {
                    return queryObj;
                }

                if (query.indexOf('?') === 0) {
                    query = query.replace('?', '');
                }

                if (query.indexOf('&') >= 0) {
                    query = query.split('&');
                } else {
                    query = [query];
                }

                for (var i = 0; i < query.length; i++) {

                    var item = query[i].split('=');

                    var name = item[0];

                    var value = decodeURIComponent(item[1]);

                    if (value.indexOf('|') >= 0) {
                        value = value.split('|');
                    } else {
                        value = [value];
                    }

                    queryObj[name] = value;

                }

                return queryObj;

            },
            countInArray: function(array, what) {
                var count = 0;
                for (var i = 0; i < array.length; i++) {
                    if (array[i] === what) {
                        count++;
                    }
                }
                return count;
            },
            removeFromArray: function(data, item) {

                var index = data.indexOf(item);

                if (index > -1) {
                    data.splice(index, 1);
                }

                return data;
            }

        };

        $(function() {
            tcgPrinter.init();
        });;
        // /**
        //  * Created by adamyoungers on 10/31/17.
        //  */
        // //alert('PDF Loaded');
        //
        // unitTest.pdf = function () {
        //     return {
        //         init: function () {
        //             return 10;
        //         }
        //     };
        // };
        //# sourceMappingURL=main.js.map
    </script>

    <!-- /JS -->


</body>

</html>